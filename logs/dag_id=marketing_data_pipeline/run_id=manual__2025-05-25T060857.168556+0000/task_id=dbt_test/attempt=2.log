[2025-05-25T06:19:12.159+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: marketing_data_pipeline.dbt_test manual__2025-05-25T06:08:57.168556+00:00 [queued]>
[2025-05-25T06:19:12.204+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: marketing_data_pipeline.dbt_test manual__2025-05-25T06:08:57.168556+00:00 [queued]>
[2025-05-25T06:19:12.214+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-05-25T06:19:12.296+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): dbt_test> on 2025-05-25 06:08:57.168556+00:00
[2025-05-25T06:19:12.316+0000] {standard_task_runner.py:60} INFO - Started process 757 to run task
[2025-05-25T06:19:12.326+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'marketing_data_pipeline', 'dbt_test', 'manual__2025-05-25T06:08:57.168556+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/main_pipeline_dag.py', '--cfg-path', '/tmp/tmpu15oan2m']
[2025-05-25T06:19:12.331+0000] {standard_task_runner.py:88} INFO - Job 19: Subtask dbt_test
[2025-05-25T06:19:12.500+0000] {task_command.py:423} INFO - Running <TaskInstance: marketing_data_pipeline.dbt_test manual__2025-05-25T06:08:57.168556+00:00 [running]> on host fe289fe396bd
[2025-05-25T06:19:12.720+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='yashbhawsar872@gmail.com' AIRFLOW_CTX_DAG_OWNER='Yash' AIRFLOW_CTX_DAG_ID='marketing_data_pipeline' AIRFLOW_CTX_TASK_ID='dbt_test' AIRFLOW_CTX_EXECUTION_DATE='2025-05-25T06:08:57.168556+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-25T06:08:57.168556+00:00'
[2025-05-25T06:19:12.724+0000] {main_pipeline_dag.py:28} INFO - ‚ñ∂Ô∏è Starting task: Run all dbt tests
[2025-05-25T06:19:12.736+0000] {utils.py:63} INFO - Running command: cd /opt/dbt/marketing_pipeline && dbt test 
[2025-05-25T06:19:16.973+0000] {utils.py:72} INFO - [0m06:19:16  Running with dbt=1.9.4
[2025-05-25T06:19:20.751+0000] {utils.py:72} INFO - [0m06:19:20  Registered adapter: snowflake=1.9.4
[2025-05-25T06:19:23.415+0000] {utils.py:72} INFO - [0m06:19:23  Found 6 models, 24 data tests, 3 sources, 479 macros
[2025-05-25T06:19:23.446+0000] {utils.py:72} INFO - [0m06:19:23
[2025-05-25T06:19:23.461+0000] {utils.py:72} INFO - [0m06:19:23  Concurrency: 4 threads (target='dev')
[2025-05-25T06:19:23.475+0000] {utils.py:72} INFO - [0m06:19:23
[2025-05-25T06:19:25.902+0000] {utils.py:72} INFO - [0m06:19:25  1 of 24 START test last_modified_after_created_stg_contacts_last_modified_at ... [RUN]
[2025-05-25T06:19:25.909+0000] {utils.py:72} INFO - [0m06:19:25  2 of 24 START test not_null_mart_contacts_contact_id ........................... [RUN]
[2025-05-25T06:19:25.917+0000] {utils.py:72} INFO - [0m06:19:25  3 of 24 START test not_null_mart_contacts_created_at ........................... [RUN]
[2025-05-25T06:19:25.925+0000] {utils.py:72} INFO - [0m06:19:25  4 of 24 START test not_null_mart_contacts_email ................................ [RUN]
[2025-05-25T06:19:27.029+0000] {utils.py:72} INFO - [0m06:19:27  1 of 24 PASS last_modified_after_created_stg_contacts_last_modified_at ......... [[32mPASS[0m in 1.09s]
[2025-05-25T06:19:27.100+0000] {utils.py:72} INFO - [0m06:19:27  2 of 24 PASS not_null_mart_contacts_contact_id ................................. [[32mPASS[0m in 1.09s]
[2025-05-25T06:19:27.377+0000] {utils.py:72} INFO - [0m06:19:27  5 of 24 START test not_null_mart_contacts_upload_date .......................... [RUN]
[2025-05-25T06:19:27.643+0000] {utils.py:72} INFO - [0m06:19:27  6 of 24 START test not_null_mart_form_fills_contact_id ......................... [RUN]
[2025-05-25T06:19:28.397+0000] {utils.py:72} INFO - [0m06:19:28  3 of 24 PASS not_null_mart_contacts_created_at ................................. [[32mPASS[0m in 2.43s]
[2025-05-25T06:19:28.493+0000] {utils.py:72} INFO - [0m06:19:28  4 of 24 PASS not_null_mart_contacts_email ...................................... [[32mPASS[0m in 2.49s]
[2025-05-25T06:19:28.784+0000] {utils.py:72} INFO - [0m06:19:28  7 of 24 START test not_null_mart_form_fills_form_id ............................ [RUN]
[2025-05-25T06:19:28.915+0000] {utils.py:72} INFO - [0m06:19:28  8 of 24 START test not_null_mart_form_fills_submitted_at ....................... [RUN]
[2025-05-25T06:19:29.470+0000] {utils.py:72} INFO - [0m06:19:29  5 of 24 PASS not_null_mart_contacts_upload_date ................................ [[32mPASS[0m in 1.81s]
[2025-05-25T06:19:29.536+0000] {utils.py:72} INFO - [0m06:19:29  6 of 24 PASS not_null_mart_form_fills_contact_id ............................... [[32mPASS[0m in 1.87s]
[2025-05-25T06:19:29.745+0000] {utils.py:72} INFO - [0m06:19:29  9 of 24 START test not_null_mart_website_activity_contact_id ................... [RUN]
[2025-05-25T06:19:29.834+0000] {utils.py:72} INFO - [0m06:19:29  10 of 24 START test not_null_mart_website_activity_event_time .................. [RUN]
[2025-05-25T06:19:30.618+0000] {utils.py:72} INFO - [0m06:19:30  8 of 24 PASS not_null_mart_form_fills_submitted_at ............................. [[32mPASS[0m in 1.46s]
[2025-05-25T06:19:30.647+0000] {utils.py:72} INFO - [0m06:19:30  7 of 24 PASS not_null_mart_form_fills_form_id .................................. [[32mPASS[0m in 1.60s]
[2025-05-25T06:19:30.845+0000] {utils.py:72} INFO - [0m06:19:30  11 of 24 START test not_null_mart_website_activity_session_id .................. [RUN]
[2025-05-25T06:19:30.891+0000] {utils.py:72} INFO - [0m06:19:30  12 of 24 START test not_null_stg_contacts_contact_id ........................... [RUN]
[2025-05-25T06:19:31.442+0000] {utils.py:72} INFO - [0m06:19:31  9 of 24 PASS not_null_mart_website_activity_contact_id ......................... [[32mPASS[0m in 1.58s]
[2025-05-25T06:19:31.544+0000] {utils.py:72} INFO - [0m06:19:31  13 of 24 START test not_null_stg_form_fills_contact_id ......................... [RUN]
[2025-05-25T06:19:31.589+0000] {utils.py:72} INFO - [0m06:19:31  10 of 24 PASS not_null_mart_website_activity_event_time ........................ [[32mPASS[0m in 1.64s]
[2025-05-25T06:19:31.847+0000] {utils.py:72} INFO - [0m06:19:31  14 of 24 START test not_null_stg_form_fills_form_id ............................ [RUN]
[2025-05-25T06:19:32.565+0000] {utils.py:72} INFO - [0m06:19:32  11 of 24 PASS not_null_mart_website_activity_session_id ........................ [[32mPASS[0m in 1.62s]
[2025-05-25T06:19:32.589+0000] {utils.py:72} INFO - [0m06:19:32  12 of 24 PASS not_null_stg_contacts_contact_id ................................. [[32mPASS[0m in 1.45s]
[2025-05-25T06:19:32.671+0000] {utils.py:72} INFO - [0m06:19:32  15 of 24 START test not_null_stg_website_activity_contact_id ................... [RUN]
[2025-05-25T06:19:32.680+0000] {utils.py:72} INFO - [0m06:19:32  16 of 24 START test not_null_stg_website_activity_session_id ................... [RUN]
[2025-05-25T06:19:32.894+0000] {utils.py:72} INFO - [0m06:19:32  13 of 24 PASS not_null_stg_form_fills_contact_id ............................... [[32mPASS[0m in 1.26s]
[2025-05-25T06:19:32.993+0000] {utils.py:72} INFO - [0m06:19:32  14 of 24 PASS not_null_stg_form_fills_form_id .................................. [[32mPASS[0m in 1.13s]
[2025-05-25T06:19:33.022+0000] {utils.py:72} INFO - [0m06:19:33  17 of 24 START test orphaned_mart_fks_mart_form_fills_contact_id ............... [RUN]
[2025-05-25T06:19:33.198+0000] {utils.py:72} INFO - [0m06:19:33  18 of 24 START test orphaned_mart_fks_mart_website_activity_contact_id ......... [RUN]
[2025-05-25T06:19:33.633+0000] {utils.py:72} INFO - [0m06:19:33  16 of 24 PASS not_null_stg_website_activity_session_id ......................... [[32mPASS[0m in 0.92s]
[2025-05-25T06:19:33.673+0000] {utils.py:72} INFO - [0m06:19:33  19 of 24 START test unique_mart_contacts_contact_id ............................ [RUN]
[2025-05-25T06:19:33.766+0000] {utils.py:72} INFO - [0m06:19:33  15 of 24 PASS not_null_stg_website_activity_contact_id ......................... [[32mPASS[0m in 1.06s]
[2025-05-25T06:19:33.823+0000] {utils.py:72} INFO - [0m06:19:33  17 of 24 FAIL 3000 orphaned_mart_fks_mart_form_fills_contact_id ................ [[31mFAIL 3000[0m in 0.71s]
[2025-05-25T06:19:33.879+0000] {utils.py:72} INFO - [0m06:19:33  20 of 24 START test unique_mart_form_fills_form_id ............................. [RUN]
[2025-05-25T06:19:33.926+0000] {utils.py:72} INFO - [0m06:19:33  21 of 24 START test unique_mart_website_activity_session_id .................... [RUN]
[2025-05-25T06:19:34.108+0000] {utils.py:72} INFO - [0m06:19:34  18 of 24 FAIL 3000 orphaned_mart_fks_mart_website_activity_contact_id .......... [[31mFAIL 3000[0m in 0.85s]
[2025-05-25T06:19:34.182+0000] {utils.py:72} INFO - [0m06:19:34  22 of 24 START test unique_stg_contacts_contact_id ............................. [RUN]
[2025-05-25T06:19:34.603+0000] {utils.py:72} INFO - [0m06:19:34  19 of 24 PASS unique_mart_contacts_contact_id .................................. [[32mPASS[0m in 0.92s]
[2025-05-25T06:19:34.616+0000] {utils.py:72} INFO - [0m06:19:34  23 of 24 START test unique_stg_form_fills_form_id .............................. [RUN]
[2025-05-25T06:19:35.043+0000] {utils.py:72} INFO - [0m06:19:35  21 of 24 PASS unique_mart_website_activity_session_id .......................... [[32mPASS[0m in 1.07s]
[2025-05-25T06:19:35.098+0000] {utils.py:72} INFO - [0m06:19:35  20 of 24 PASS unique_mart_form_fills_form_id ................................... [[32mPASS[0m in 1.18s]
[2025-05-25T06:19:35.129+0000] {utils.py:72} INFO - [0m06:19:35  24 of 24 START test unique_stg_website_activity_session_id ..................... [RUN]
[2025-05-25T06:19:35.185+0000] {utils.py:72} INFO - [0m06:19:35  22 of 24 PASS unique_stg_contacts_contact_id ................................... [[32mPASS[0m in 1.00s]
[2025-05-25T06:19:35.321+0000] {utils.py:72} INFO - [0m06:19:35  23 of 24 PASS unique_stg_form_fills_form_id .................................... [[32mPASS[0m in 0.69s]
[2025-05-25T06:19:35.816+0000] {utils.py:72} INFO - [0m06:19:35  24 of 24 PASS unique_stg_website_activity_session_id ........................... [[32mPASS[0m in 0.64s]
[2025-05-25T06:19:37.314+0000] {utils.py:72} INFO - [0m06:19:37
[2025-05-25T06:19:37.363+0000] {utils.py:72} INFO - [0m06:19:37  Finished running 24 data tests in 0 hours 0 minutes and 13.83 seconds (13.83s).
[2025-05-25T06:19:38.600+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.630+0000] {utils.py:72} INFO - [0m06:19:38  [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[2025-05-25T06:19:38.651+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.685+0000] {utils.py:72} INFO - [0m06:19:38  [31mFailure in test orphaned_mart_fks_mart_form_fills_contact_id (models/marts/schema.yml)[0m
[2025-05-25T06:19:38.710+0000] {utils.py:72} INFO - [0m06:19:38    Got 3000 results, configured to fail if != 0
[2025-05-25T06:19:38.719+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.731+0000] {utils.py:72} INFO - [0m06:19:38    compiled code at target/compiled/marketing_pipeline/models/marts/schema.yml/orphaned_mart_fks_mart_form_fills_contact_id.sql
[2025-05-25T06:19:38.744+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.765+0000] {utils.py:72} INFO - [0m06:19:38  [31mFailure in test orphaned_mart_fks_mart_website_activity_contact_id (models/marts/schema.yml)[0m
[2025-05-25T06:19:38.778+0000] {utils.py:72} INFO - [0m06:19:38    Got 3000 results, configured to fail if != 0
[2025-05-25T06:19:38.784+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.801+0000] {utils.py:72} INFO - [0m06:19:38    compiled code at target/compiled/marketing_pipeline/models/marts/schema.yml/orphaned_mart_fks_mart_website_activity_contact_id.sql
[2025-05-25T06:19:38.818+0000] {utils.py:72} INFO - [0m06:19:38
[2025-05-25T06:19:38.836+0000] {utils.py:72} INFO - [0m06:19:38  Done. PASS=22 WARN=0 ERROR=2 SKIP=0 TOTAL=24
[2025-05-25T06:19:41.071+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/main_pipeline_dag.py", line 29, in _wrapped
    fn(**kwargs)
  File "/opt/airflow/scripts/utils.py", line 76, in run_dbt
    raise RuntimeError(f"dbt command failed with exit code {return_code}")
RuntimeError: dbt command failed with exit code 1
[2025-05-25T06:19:41.153+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=marketing_data_pipeline, task_id=dbt_test, execution_date=20250525T060857, start_date=20250525T061912, end_date=20250525T061941
[2025-05-25T06:19:41.155+0000] {taskinstance.py:1116} ERROR - Error when executing notify_failure callback
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 2334, in _run_raw_task
    self._execute_task_with_callbacks(context, test_mode, session=session)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 2499, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 2516, in _execute_task
    return _execute_task(self, context, task_orig)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/main_pipeline_dag.py", line 29, in _wrapped
    fn(**kwargs)
  File "/opt/airflow/scripts/utils.py", line 76, in run_dbt
    raise RuntimeError(f"dbt command failed with exit code {return_code}")
RuntimeError: dbt command failed with exit code 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 1113, in _run_finished_callback
    callback(context)
TypeError: notify_failure() takes 0 positional arguments but 1 was given
[2025-05-25T06:19:41.199+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 19 for task dbt_test (dbt command failed with exit code 1; 757)
[2025-05-25T06:19:41.244+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-05-25T06:19:41.306+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
